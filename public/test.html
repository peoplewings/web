<script>

(function(exports) {

	var toArray = Function.prototype.call.bind(Array.prototype.slice);

	function repeat(text, count) {
		return Array(count + 1).join(text);
	}

	function wrapFunction(argCount, fn) {
		switch (argCount) {
			case 0: return function()                  { return fn.apply(this, arguments) };
			case 1: return function(a)                 { return fn.apply(this, arguments) };
			case 2: return function(a,b)               { return fn.apply(this, arguments) };
			case 3: return function(a,b,c)             { return fn.apply(this, arguments) };
			case 4: return function(a,b,c,d)           { return fn.apply(this, arguments) };
			case 5: return function(a,b,c,d,e)         { return fn.apply(this, arguments) };
			case 6: return function(a,b,c,d,e,f)       { return fn.apply(this, arguments) };
			case 7: return function(a,b,c,d,e,f,g)     { return fn.apply(this, arguments) };
			case 8: return function(a,b,c,d,e,f,g,h)   { return fn.apply(this, arguments) };
			case 9: return function(a,b,c,d,e,f,g,h,i) { return fn.apply(this, arguments) };
			default: throw new Error('9+ arguments??? yo mad!?!?');
		}
	}

	function currify(fn, stack) {
		function currified() {
			var args = stack.concat(toArray(arguments));
			return args.length < fn.length ? currify(fn, args) : fn.apply(this, args);
		}

		return curry.decorate ?
			wrapFunction(fn.length - stack.length, currified) :
			currified;
	}

	exports.curry = function curry(fn) {
		return currify(fn, []);
	};

	function compose() {
		var fns = toArray(arguments).reverse();
		var first = fns.shift();

		return function() {
			return fns.reduce(function(val, fn) {
				return fn(val);
			}, first.apply(null, arguments));
		};
	}

	exports.compose = compose;


})(window);

(function(exports) {

	function binary(name, operator) {
		var fn = new Function('a', 'b', 'return b ' + operator + ' a;');
		exports[name] = curry(fn);
	}

	binary('sum', '+');
	binary('minus', '-');
	binary('divide', '/');
	binary('multiply', '*');
	binary('module', '%');
	binary('concat', '+');

	function not(val) {
		return !val;
	}
	exports.not = not;

	function dot(prop, obj) {
		return obj[prop];
	}
	exports.dot = curry(dot);

	function invoke(args, fn) {
		return fn.apply(null, args);
	}
	exports.invoke = curry(invoke);

	function method(name, args, obj) {
		return obj[name].apply(obj, args);
	}
	exports.method = curry(method);

})(window);

(function(exports) {

	function map(operation, data) {
		if (typeof data.map === 'function')
			data.map(operation);
		else
			throw new Error('no mappeable object');
	}

	Object.prototype.map = function(fn) {
		fn(this);
	};

	exports.map = curry(map);

	function maybe(value) {
		return {
			val: value,
			map: maybe_map
		}
	}
	function maybe_map(fn) {
		return this.val ? maybe(fn(this.val)) : this;
	}
	exports.maybe = maybe;

	function def(def, value) {
		return {
			def: def,
			val: value,
			map: def_map
		}
	}
	function def_map(fn) {
		return this.val ? def(this.def, fn(this.val)) : def(this.def, fn(this.def));
	}
	exports.def = def;

})(window);

</script>
















<script>


var isPair = compose(not, module(2));
var ifIsPair = compose(maybe, isPair);
var log = console.log.bind(console);
var print = map(log);
var app = compose(print, ifIsPair);

app(0);
app(1);
app(2);

</script>































<script>

function assert(val, msg) {
	if (!val) throw new Error(msg);
}

var called = false;
function sut(a, b, c) {
	called = true;
}

var test = curry(sut);

test();
assert(!called, 'is called with no arguments');

test(1);
assert(!called, 'is called with one argument');

test(1, 2);
assert(!called, 'is called with two arguments');

test(1, 2, 3);
assert(called, 'is not called with three arguments');
called = false;

test(1)(2)
assert(!called, 'is called on second call with one argument');

test(1)(2)(3)
assert(called, 'is not called on thirth call with one argument');
called = false;

test(1, 2)(3)
assert(called, 'is not called after one call with two and one call with one argument');
called = false;

test(1)(2, 3)
assert(called, 'is not called after one call with one and one call with two arguments');
called = false;

</script>
