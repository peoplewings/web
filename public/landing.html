<!DOCTYPE html>
<!-- paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/ -->
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

	<title>Peoplewings</title>
	<meta name="description" content="">
	<meta name="viewport" content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0, width=device-width">

	<link rel="stylesheet" href="css/landing.css">
	<link href='http://fonts.googleapis.com/css?family=Exo:500,800,500italic,800italic' rel='stylesheet' type='text/css'>
</head>

<body>
	<div class="wrapper">
		<div class="background-roller background-9"></div>

		<header>
			<div class="navbar nav navbar-fixed-top">
				<div class="navbar-inner">
					<a class="brand" href="#">Peoplewings</a>
					<div class="nav-collapse">
						<ul class="nav pull-right">
							<li class="register-menu"><a href="/#/register">SIGN UP</a></li>
							<li class="login-menu"><a href="/#/login">LOG IN</a></li>
							<li class="help-menu"><a href="/#/help">HOW IT WORKS</a></li>
						</ul>
					</div>
				</div>
			</div>
		</header>

		<div id="main" class="navbar-inner">
			<section id="sharing" class="navbar-inner">
				<h1>Sharing the world</h1>
				<h2>Free shares and make new friends</h2>
			</section>
			<section id="categories" class="navbar-inner">
				<ul id="options">
					<li><a href="#" class="icon all">All</a><span>coming soon!</span></li>
					<li><a href="#" class="icon accommodation selected">Acommodation</a><span class="span-accommodation">accommodation!</span></li>
					<li><a href="#" class="icon transport">Transport</a><span class="span-transport">coming soon!</span></li>
					<li><a href="#" class="icon travel">Travel</a><span class="span-travel">coming soon!</span></li>
				</ul>
			</section>
			<section id="landing-form" class="navbar-inner">
				<form id="accomodation-search-form">
					<div class="control-group">
						<label class="control-label wings_text" for="inputWings">WINGS</label>
						<input type="text" id="inputWings" name="wings" placeholder="Where do you need accomodation?">
					</div>
					<div class="control-group">
						<label class="control-label people_text" for="inputPeople">PEOPLE</label>
						<div class="controls">
							<select name="startAge">
								<option value="18">Age 18</option>
							</select>
							<select name="endAge">
								<option value="99">Age 99</option>
							</select>
						</div>
					</div>
					<button type="submit" class="button-peoplewings">Search Peoplewings</button>
				</form>
			</section>
		</div>

		<div id="middle">
			<div>
				<ul>
					<li><img src="../img/spot_car.png" class="spot house"></li>
					<li><img src="../img/spot_house.png" class="spot car"></li>
					<li><img src="../img/spot_trip.png" class="spot trip"></li>
				</ul>
			</div>
		</div>

		<div class="push"></div>
	</div>

	<footer class="footer navbar navbar-fixed-bottom">
		<div class="navbar-inner">

			<div id="terms">
				<ul id="service-terms">
					<li>Â©2013 PEOPLEWINGS</li>
					<li><a href="#">Terms of Service</a></li>
					<li><a href="#">Privacy Policy</a></li>
					<li><a href="#">Help</a></li>
				</ul>
			</div>
			<div id="follow">
				<p>Follow us ...</p>
				<ul>
					<li><a href="https://www.facebook.com/PEOPLEWINGS " class="icon follow facebook">facebook</a></li>
					<li><a href="https://twitter.com/PEOPLEWINGS " class="icon follow twitter">twitter</a></li>
					<li><a href="http://www.youtube.com/user/PeopleWings" class="icon follow youtube">youtube</a></li>
				</ul>
			</div>
		</div>
	</footer>

	<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyABBKjubUcAk69Kijktx-s0jcNL1cIjZ98&sensor=false&libraries=places&language=en"></script>
	<script type="text/javascript" src="js/lib/jquery.js"></script>
	<script type="text/javascript">
	$(function() {

		$('[name="startAge"],[name="endAge"]').html(Array(41).join().split(',').map(function(_, index) {
			var num = 18 + index * 2;
			return '<option value="' + num + '">' + num + '</option>';
		}).join(''));
		$('[name="endAge"]').val(98);

		$('#accomodation-search-form').on('submit', function() {
			if (+$('select[name="endAge"]').val() < +$('select[name="startAge"]').val()) {
				$('.form-errors').html('The start age is bigger than end age');
				return false;
			}

			document.location =
			'index.html#/search/?capacity=1&language=all&type=Host&gender=Both&page=1&' +
			$('#accomodation-search-form [name]')
			.toArray()
			.map($)
			.map(function(input) {
				if ('inputWings' === input.attr('id') && parsedCity)
					input.val(parsedCity);
				else
					input.val(input.val().split(',')[0]);
				if (input.val())
					return encodeURIComponent(input.attr('name')) + '=' + encodeURIComponent(input.val());

			})
			.filter(Boolean)
			.join('&');

			return false;
		});

		var search = new google.maps.places.Autocomplete(document.getElementById('inputWings'), { types: ['(cities)'] });

		var parsedCity = null;

		var parsePlace = function(){
			function getCC(addressComponents){
				var data = {};
				for (component in addressComponents){
					for (type in addressComponents[component].types){
						switch (addressComponents[component].types[type]) {
							case "locality":
							data.city = addressComponents[component].long_name;
							break;
							case "country":
							data.country = addressComponents[component].long_name;
							break;
							case "administrative_area_level_1":
							data.region = addressComponents[component].long_name;
							break;
						}
					}
				}
				return data;
			}
			parsedCity = getCC(search.getPlace().address_components).city;
		}

		google.maps.event.addListener(search, 'place_changed', parsePlace);

		$('ul#options li span').hide();

		$('ul#options li a').hover(function(e){
			e.preventDefault();
			var tip = e.target.parentNode.getElementsByTagName('span');
			$(tip).show();
		},
		function(e){
			e.preventDefault();
			var tip = e.target.parentNode.getElementsByTagName('span');
			$(tip).hide();
		});


	});

</script>
</body>
</html>
